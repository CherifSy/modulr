<div class="page">

    <ul class="nav nav-tabs sections">
        <li ui-sref-active="active"><a href="" ui-sref="layout.users">{{'USERS' | translate}}</a></li>
        <li ui-sref-active="active"><a href="" ui-sref="layout.access">{{'ACCESS' | translate}}</a></li>
        <li ui-sref-active="active"><a href="" ui-sref="layout.roles">{{'ROLES' | translate}}</a></li>
    </ul>

    <br>

    <div class="row">
        <div class="col-md-4">
            <div class="panel min-box">
                <span class="fa-stack fa-3x text-primary">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-users fa-stack-1x fa-inverse"></i>
                </span>
                <div>
                    <h2>{{ countUsers.total }}</h2>
                    <p>{{ 'USERS' | translate }}</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="panel min-box">
                <span class="fa-stack fa-3x text-success">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-user fa-stack-1x fa-inverse"></i>
                </span>
                <div>
                    <h2>{{ countUsers.active }}</h2>
                    <p>{{ 'USERS.ACTIVE' | translate }}</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="panel min-box">
                <span class="fa-stack fa-3x text-danger">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-user-secret fa-stack-1x fa-inverse"></i>
                </span>
                <div>
                    <h2>{{ countUsers.deactive }}</h2>
                    <p>{{ 'USERS.DEACTIVE' | translate }}</p>
                </div>
            </div>
        </div>
    </div><!-- /.row -->

    <div class="row">
        <div class="col-md-12">
            <div class="panel">
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="input-group">
                                <span class="input-group-addon"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></span>
                                <input type="text" class="form-control" placeholder="{{ 'SEARCH' | translate }}" ng-model="filters">
                            </div>
                        </div>
                        <div class="col-md-8 text-right">
                            <button type="button" class="btn btn-success" data-toggle="modal" data-target="#modalUser">
                                <i class="fa fa-user-plus"></i> {{ 'CREATE' | translate }}
                            </button>
                            <!-- <button type="button" class="btn btn-default" data-toggle="modal" data-target="#modalCreateUser">
                                <i class="fa fa-key"></i> {{ 'ACCESS' | translate }}
                            </button> -->
                            <!-- <a href=""  ng-class="editMode.users" ng-click="activateUsers($event)">{{ 'USERS.ACTIVATE' | translate }}</a>
                            <a href=""  ng-class="editMode.users" ng-click="deactivateUsers($event)">{{ 'USERS.DEACTIVATE' | translate }}</a>
                            <a href=""  ng-class="editMode.users" ng-click="deleteUsers($event)">{{ 'DELETE' | translate }}</a> -->
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                    <hr>
                    <div class="row">
                        <div class="col-md-12">
                            <div tasty-table bind-resource="tableResource" watch-resource="collection" bind-filters="filters" bind-theme="tableResource.custom">
                                <div class="table-responsive">
                                    <table class="table table-striped table-hover">
                                        <thead tasty-thead bind-not-sort-by="['avatar','id']"></thead>
                                        <tbody>
                                            <tr ng-repeat="row in rows" ng-dblclick="goToProfile(row.id)"> <!-- ng-class="{'selected':row.selected}" ng-click="selectedRow(row)" -->
                                                <td class="avatar"><img ng-src="{{row.avatar}}" class="img-circle"></td>
                                                <td><a class="btn-link" href="/profile/{{row.id}}">{{ row.username }}</a></td>
                                                <td>{{ row.email }}</td>
                                                <td>{{ row.role.role }}</td>
                                                <td>
                                                    <span class="glyphicon" aria-hidden="true" ng-class="{'glyphicon-ok-circle text-success': row.active, 'glyphicon-ban-circle text-danger': ! row.active}"></span>
                                                </td>
                                                <td>{{ row.createdAt | amDateFormat:'LL' }}</td>
                                                <td>
                                                    <span class="dropdown pull-right">
                                                        <a href="" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                                                            <span class="glyphicon glyphicon-option-vertical"></span>
                                                        </a>
                                                        <ul class="dropdown-menu dropdown-menu-right">
                                                            <li><a href="" ng-click="activateUser(row)">{{ 'USERS.ACTIVATE' | translate }}</a></li>
                                                            <li><a href="" ng-click="deactivateUser(row)">{{ 'USERS.DEACTIVATE' | translate }}</a></li>
                                                            <li class="divider"></li>
                                                            <li><a href="" ng-click="editUser(row)">{{ 'EDIT' | translate }}</a></li>
                                                            <li><a href="" ng-click="deleteUser(row)">{{ 'DELETE' | translate }}</a></li>
                                                            <li class="divider"></li>
                                                            <li ng-class="{disabled: !row.active}"><a href="" ng-click="sendUserData(row)">{{ 'SEND' | translate }} {{ 'USERS.INFORMATION' | translate }}</a></li>
                                                        </ul>
                                                    </span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div tasty-pagination></div>
                            </div>
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                </div><!-- /.panel-body -->
            </div><!-- /.panel -->
        </div><!-- /.col -->
    </div><!-- /.row -->

</div><!-- /.page -->

<!--
* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
* Modals
* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
-->
<!-- Modal Create User -->
<div class="modal fade" id="modalUser" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel" ng-if="!show.editUser">{{ 'USERS.NEWUSER' | translate }}</h4>
                <h4 class="modal-title" id="myModalLabel" ng-if="show.editUser">{{ 'USERS.EDITUSER' | translate }}</h4>
            </div>
            <form id="formUser">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="control-label">{{ 'USERS.USERNAME' | translate }}</label>
                                <input type="text" class="form-control" placeholder="john" data-smk-type="alphanumeric" ng-model="formUser.username" required autofocus>
                            </div>
                        </div><!-- /.col -->
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="control-label">{{ 'USERS.EMAIL' | translate }}</label>
                                <input type="email" class="form-control" placeholder="john.doe@company.com" ng-model="formUser.email" required>
                            </div>
                        </div><!-- /.col -->
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="control-label">{{ 'USERS.PASSWORD' | translate }}</label>
                                <div class="input-group">
                                    <input type="password" class="form-control" placeholder="{{ 'USERS.PASSWORD' | translate }}" ng-model="formUser.password" required>
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default" ng-click="generatePassword()">{{ 'USERS.GENERATE' | translate }} {{ 'USERS.PASSWORD' | translate }}</button>
                                    </span>
                                </div><!-- /input-group -->
                            </div>
                        </div><!-- /.col -->
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="control-label">{{ 'USERS.ROLE' | translate }}</label>
                                <mdr-select2 url="{{urlAPI}}/userrole" options="role.role for role in roles | orderBy:'role' track by role.id" model="formUser.role" selected="formUser.role.id" required="true"></mdr-select2>
                                {{formUser.role}}
                            </div>
                            <a class="btn btn-link" role="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">Custom authorizations</a>
                            <div class="collapse" id="collapseExample">
                                <role-authorizations set-authorizations="formUser.setAuthorizations" get-authorizations="formUser.authorizations"></role-authorizations>
                            </div>
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                </div><!-- /.modal-body -->
                <div class="modal-footer">
                    <div class="checkbox pull-left">
                        <label>
                            <input type="checkbox" ng-model="formUser.active" data-smk-noclear> {{ 'USERS.ACTIVE' | translate }}
                        </label>
                    </div>
                    <button type="button" class="btn btn-default" data-dismiss="modal">{{ 'CLOSE' | translate }}</button>
                    <button type="submit" class="btn btn-primary" data-loading-text="<i class='fa fa-circle-o-notch fa-pulse'></i> Loading..." autocomplete="off" ng-click="createUser($event)" ng-if="!show.editUser">{{ 'ADD' | translate }}</button>
                    <button type="submit" class="btn btn-primary" data-loading-text="<i class='fa fa-circle-o-notch fa-pulse'></i> Loading..." autocomplete="off" ng-click="updateUser($event)" ng-if="show.editUser">{{ 'SAVE' | translate }}</button>
                </div><!-- /.modal-footer -->
            </form>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
